---
layout: publication
title: Virtual Analog Modeling Using Neural ODEs
description: Audio examples for "Virtual Analog Modeling Of Distortion Circuits Using Neural Ordinary Differential Equations" DAFx20in22 conference paper
assets: /assets/wav/publications/dafx2022/
custom_css:
 - https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css
 - /assets/js/trackswitch/css/trackswitch.min.css
custom_js:
 - /assets/js/trackswitch/js/trackswitch.min.js
 - /assets/js/trackswitch/js/load_trackswitch.js
---

<h2>Audio Examples for "Virtual Analog Modeling Of Distortion Circuits Using Neural
Ordinary Differential Equations" DAFx20in22 Conference paper</h2>

<p>This page contains audio examples for the "Virtual Analog Modeling Of Distortion Circuits Using Neural
Ordinary Differential Equations" paper presented at the 25th International Conference on Digital Audio Effects (DAFx20in22) in Vienna, Austria, September 2022.</p>

<h3>Authors</h3>

<ul>
    <li>Jan Wilczek</li>
    <li>Alec Wright</li>
    <li>Vesa Välimäki</li>
    <li>Emanuël Habets</li>
</ul>

<h3>Abstract</h3>

<p>Recent research in deep learning has shown that neural networks
    are capable of learning the derivative of a dynamical system. In
    this paper, we adapt this concept to Virtual Analog (VA) modeling
    to learn the ordinary differential equations (ODEs) governing the
    first-order and the second-order diode clipper. The proposed models achieve performance comparable to state-of-the-art recurrent
    neural networks (RNNs) albeit using fewer parameters. We show
    that this approach does not require oversampling and allows to increase the sampling rate after the training has completed, what results in increased accuracy. Using a sophisticated numerical solver
    allows to increase the accuracy at the cost of slower processing.
    ODEs learned this way do not require closed forms but are still
    physically interpretable.
</p>

<h3>Audio Examples</h3>

<h4>First-Order Diode Clipper</h4>

<div class="player">
    <p>
        Example trackswitch.js instance.
    </p>
    <ts-track title="Bass 1">
        <ts-source src="{{ page.assets | append: "diode_clipper/22050/Bass1_input.flac" }}" type="audio/flac"></ts-source>
    </ts-track>
  </div>

<table class="table table-striped table-hover table-responsive">
    <caption>First-order diode clipper audio examples.</caption>
    <thead>
        <tr>
            <th scope="col">Sample</th>
            <th scope="col">Sampling<br>Rate [Hz]</th>
            <th scope="col">Input</th>
            <th scope="col">Target</th>
            <th scope="col">LSTM8</th>
            <th scope="col">STN</th>
            <th scope="col">ODENet9(FE)</th>
            <th scope="col">ODENet9(IA)</th>
        </tr>
    </thead>
    <tbody>
        <!-- Bass #1 -->
        <tr>
            <th scope="row" rowspan="4">Bass #1</td>
            <td>44100</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>22050</td>
            <td>
                {% include embed-audio.html src="/assets/wav/publications/dafx2022/diode_clipper/22050/Bass1_input.wav" %}
            </td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>48000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>192000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <!-- Bass #2 -->
        <tr>
            <th scope="row" rowspan="4">Bass #2</td>
            <td>44100</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>22050</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>48000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>192000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <!-- Guitar #1 -->
        <tr>
            <th scope="row" rowspan="4">Guitar #1</td>
            <td>44100</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>22050</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>48000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>192000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <!-- Guitar #2 -->
        <tr>
            <th scope="row" rowspan="4">Guitar #2</td>
            <td>44100</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>22050</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>48000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>192000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
    </tbody>
</table>


<h4>Second-Order Diode Clipper</h4>

<table class="table table-striped table-hover table-responsive">
    <caption>Second-order diode clipper audio examples.</caption>
    <thead>
        <tr>
            <th scope="col">Sample</th>
            <th scope="col">Sampling<br>Rate [Hz]</th>
            <th scope="col">Input</th>
            <th scope="col">Target</th>
            <th scope="col">LSTM16</th>
            <th scope="col">STN 2x30</th>
            <th scope="col">ODENet20(FE)</th>
            <th scope="col">ODENet30(FE)</th>
        </tr>
    </thead>
    <tbody>
        <!-- Bass #1 -->
        <tr>
            <th scope="row" rowspan="4">Bass #1</td>
            <td>44100</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>22050</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>48000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>192000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <!-- Bass #2 -->
        <tr>
            <th scope="row" rowspan="4">Bass #2</td>
            <td>44100</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>22050</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>48000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>192000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <!-- Guitar #1 -->
        <tr>
            <th scope="row" rowspan="4">Guitar #1</td>
            <td>44100</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>22050</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>48000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>192000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <!-- Guitar #2 -->
        <tr>
            <th scope="row" rowspan="4">Guitar #2</td>
            <td>44100</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>22050</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>48000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
        <tr>
            <td>192000</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
            <td>file</td>
        </tr>
    </tbody>
</table>
